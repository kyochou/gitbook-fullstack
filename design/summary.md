# Design

## 秒杀系统
秒杀系统本质上就是一个满足大并发, 高性能和高可用的分布式系统.
秒杀就是同时处理大量的并发读和并发写.

### 架构原则 
如果你是一个架构师, 你首先要勾勒出一个轮廓, 想一想如何构建一个超大流量并发读写, 高性能, 以及高可用的系统, 这其中有哪些要素需要考虑.

* 数据要尽量少

    在网络间传输的数据(请求和回应)能少就少. 
    应用之间的调用能少就少.
    数据越简单, 越小越好.
    数据的压缩, 编码, 序列化等操作都是 CPU 杀手.
    
* 请求数要尽量少

    合并静态文件.
    减少 DNS 解析耗时.
    
* 路径要尽量短

    所谓 "路径", 就是用户发出请求到返回数据这个过程中, 需要经过的中间节点数(服务端调用).
    一种解决方法是将多个相互强依赖的应用合并部署, 把远程过程调用(RPC) 变成 JVM 内部之间的方法调用.
    
* 依赖要尽量少

    所谓依赖, 指的是要完成一次用户请求必须依赖的系统或服务.
    可以给系统进行分级, 保证高优先级的系统不会被低优先级的系统拖跨.    

* 不要有单点

    单点意味着没有备份, 风险不可控. 我们设计分布式系统最重要的原则就是 "消除单点". 
    避免单点的关键是避免将服务的状态和机器绑定, 即把服务无状态化(保护幂等性).
    像存储这类的服务本身很难无状态化. 因为数据要存储在磁盘上, 本身就要和机器绑定, 那么这种场景一般要通过冗余多个备份的方式来解决单点问题.
    
    
**架构是一种平衡的艺术, 最好的架构一旦脱离了它所适应的场景, 一切都将是空谈**.    
要取得极致的性能, 就要在其他方面(如通用性, 易用性, 成本等)有所牺牲.